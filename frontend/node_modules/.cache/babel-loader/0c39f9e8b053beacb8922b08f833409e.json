{"remainingRequest":"D:\\test\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\test\\frontend\\src\\store\\index.js","dependencies":[{"path":"D:\\test\\frontend\\src\\store\\index.js","mtime":1742954353547},{"path":"D:\\test\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747724956321},{"path":"D:\\test\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1747724958365}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVnVleCBmcm9tICd2dWV4JzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJvdXRlciBmcm9tICcuLi9yb3V0ZXInOwpWdWUudXNlKFZ1ZXgpOwpleHBvcnQgZGVmYXVsdCBuZXcgVnVleC5TdG9yZSh7CiAgc3RhdGU6IHsKICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSB8fCAnJywKICAgIHVzZXI6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSkgfHwgbnVsbCwKICAgIGNsaWVudEluZm86IG51bGwsCiAgICBjbGllbnREaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgIGluYWN0aXZpdHlUaW1lcjogbnVsbCwKICAgIGluYWN0aXZpdHlUaW1lb3V0OiAzMCAqIDYwICogMTAwMCAvLyAzMOWIhumSn++8jOi9rOaNouS4uuavq+enkgogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRUb2tlbihzdGF0ZSwgdG9rZW4pIHsKICAgICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rva2VuJywgdG9rZW4pOwogICAgfSwKICAgIHNldFVzZXIoc3RhdGUsIHVzZXIpIHsKICAgICAgc3RhdGUudXNlciA9IHVzZXI7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyJywgSlNPTi5zdHJpbmdpZnkodXNlcikpOwogICAgfSwKICAgIGNsZWFyVXNlckluZm8oc3RhdGUpIHsKICAgICAgc3RhdGUudG9rZW4gPSAnJzsKICAgICAgc3RhdGUudXNlciA9IG51bGw7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpOwogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcicpOwogICAgICAvLyDmuIXpmaTkuI3mtLvliqjorqHml7blmagKICAgICAgaWYgKHN0YXRlLmluYWN0aXZpdHlUaW1lcikgewogICAgICAgIGNsZWFyVGltZW91dChzdGF0ZS5pbmFjdGl2aXR5VGltZXIpOwogICAgICAgIHN0YXRlLmluYWN0aXZpdHlUaW1lciA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBTRVRfQ0xJRU5UX0lORk8oc3RhdGUsIGNsaWVudEluZm8pIHsKICAgICAgc3RhdGUuY2xpZW50SW5mbyA9IGNsaWVudEluZm87CiAgICB9LAogICAgU0VUX0NMSUVOVF9ESUFMT0dfVklTSUJMRShzdGF0ZSwgdmlzaWJsZSkgewogICAgICBzdGF0ZS5jbGllbnREaWFsb2dWaXNpYmxlID0gdmlzaWJsZTsKICAgIH0sCiAgICBTRVRfSU5BQ1RJVklUWV9USU1FUihzdGF0ZSwgdGltZXIpIHsKICAgICAgc3RhdGUuaW5hY3Rpdml0eVRpbWVyID0gdGltZXI7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBhc3luYyBsb2dpbih7CiAgICAgIGNvbW1pdCwKICAgICAgZGlzcGF0Y2gKICAgIH0sIGNyZWRlbnRpYWxzKSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdCgnL2FwaS9hdXRoL2xvZ2luJywgY3JlZGVudGlhbHMpOwogICAgICBjb25zdCB7CiAgICAgICAgdG9rZW4sCiAgICAgICAgdXNlcm5hbWUKICAgICAgfSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIGNvbW1pdCgnc2V0VG9rZW4nLCB0b2tlbik7CiAgICAgIGNvbW1pdCgnc2V0VXNlcicsIHsKICAgICAgICB1c2VybmFtZQogICAgICB9KTsKCiAgICAgIC8vIOiuvue9ruWFqOWxgOivt+axguWktAogICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQXV0aG9yaXphdGlvbiddID0gYEJlYXJlciAke3Rva2VufWA7CgogICAgICAvLyDnmbvlvZXlkI7lkK/liqjkuI3mtLvliqjorqHml7blmagKICAgICAgZGlzcGF0Y2goJ3N0YXJ0SW5hY3Rpdml0eVRpbWVyJyk7CiAgICB9LAogICAgbG9nb3V0KHsKICAgICAgY29tbWl0CiAgICB9KSB7CiAgICAgIGNvbW1pdCgnY2xlYXJVc2VySW5mbycpOwogICAgICBkZWxldGUgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0F1dGhvcml6YXRpb24nXTsKICAgIH0sCiAgICAvLyDlkK/liqjoh6rliqjnmbvlh7rorqHml7blmagKICAgIHN0YXJ0SW5hY3Rpdml0eVRpbWVyKHsKICAgICAgc3RhdGUsCiAgICAgIGRpc3BhdGNoCiAgICB9KSB7CiAgICAgIC8vIOa4hemZpOeOsOacieiuoeaXtuWZqAogICAgICBpZiAoc3RhdGUuaW5hY3Rpdml0eVRpbWVyKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHN0YXRlLmluYWN0aXZpdHlUaW1lcik7CiAgICAgIH0KCiAgICAgIC8vIOiuvue9ruaWsOeahOiuoeaXtuWZqAogICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIC8vIDMw5YiG6ZKf5ZCO6Ieq5Yqo55m75Ye6CiAgICAgICAgZGlzcGF0Y2goJ2F1dG9Mb2dvdXQnKTsKICAgICAgfSwgc3RhdGUuaW5hY3Rpdml0eVRpbWVvdXQpOwoKICAgICAgLy8g5L+d5a2Y6K6h5pe25ZmoSUQKICAgICAgc3RhdGUuaW5hY3Rpdml0eVRpbWVyID0gdGltZXI7CiAgICB9LAogICAgLy8g6Ieq5Yqo55m75Ye65aSE55CGCiAgICBhdXRvTG9nb3V0KHsKICAgICAgZGlzcGF0Y2gKICAgIH0pIHsKICAgICAgLy8g5pi+56S65o+Q56S65L+h5oGvCiAgICAgIFZ1ZS5wcm90b3R5cGUuJG1lc3NhZ2Uud2FybmluZygn55Sx5LqO6ZW/5pe26Ze05pyq5pON5L2c77yM57O757uf5bey6Ieq5Yqo6YCA5Ye655m75b2VJyk7CiAgICAgIC8vIOaJp+ihjOeZu+WHugogICAgICBkaXNwYXRjaCgnbG9nb3V0Jyk7CiAgICAgIC8vIOi3s+i9rOWIsOeZu+W9lemhtQogICAgICByb3V0ZXIucHVzaCgnL2xvZ2luJyk7CiAgICB9LAogICAgLy8g6YeN572u6Ieq5Yqo55m75Ye66K6h5pe25ZmoCiAgICByZXNldEluYWN0aXZpdHlUaW1lcih7CiAgICAgIGRpc3BhdGNoCiAgICB9KSB7CiAgICAgIGRpc3BhdGNoKCdzdGFydEluYWN0aXZpdHlUaW1lcicpOwogICAgfQogIH0KfSk7"},{"version":3,"names":["Vue","Vuex","axios","router","use","Store","state","token","localStorage","getItem","user","JSON","parse","clientInfo","clientDialogVisible","inactivityTimer","inactivityTimeout","mutations","setToken","setItem","setUser","stringify","clearUserInfo","removeItem","clearTimeout","SET_CLIENT_INFO","SET_CLIENT_DIALOG_VISIBLE","visible","SET_INACTIVITY_TIMER","timer","actions","login","commit","dispatch","credentials","response","post","username","data","defaults","headers","common","logout","startInactivityTimer","setTimeout","autoLogout","prototype","$message","warning","push","resetInactivityTimer"],"sources":["D:/test/frontend/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport axios from 'axios'\r\nimport router from '../router'\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    token: localStorage.getItem('token') || '',\r\n    user: JSON.parse(localStorage.getItem('user')) || null,\r\n    clientInfo: null,\r\n    clientDialogVisible: false,\r\n    inactivityTimer: null,\r\n    inactivityTimeout: 30 * 60 * 1000 // 30分钟，转换为毫秒\r\n  },\r\n  \r\n  mutations: {\r\n    setToken(state, token) {\r\n      state.token = token\r\n      localStorage.setItem('token', token)\r\n    },\r\n    \r\n    setUser(state, user) {\r\n      state.user = user\r\n      localStorage.setItem('user', JSON.stringify(user))\r\n    },\r\n    \r\n    clearUserInfo(state) {\r\n      state.token = ''\r\n      state.user = null\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('user')\r\n      // 清除不活动计时器\r\n      if (state.inactivityTimer) {\r\n        clearTimeout(state.inactivityTimer)\r\n        state.inactivityTimer = null\r\n      }\r\n    },\r\n    \r\n    SET_CLIENT_INFO(state, clientInfo) {\r\n      state.clientInfo = clientInfo\r\n    },\r\n    \r\n    SET_CLIENT_DIALOG_VISIBLE(state, visible) {\r\n      state.clientDialogVisible = visible\r\n    },\r\n    \r\n    SET_INACTIVITY_TIMER(state, timer) {\r\n      state.inactivityTimer = timer\r\n    }\r\n  },\r\n  \r\n  actions: {\r\n    async login({ commit, dispatch }, credentials) {\r\n      const response = await axios.post('/api/auth/login', credentials)\r\n      const { token, username } = response.data\r\n      commit('setToken', token)\r\n      commit('setUser', { username })\r\n      \r\n      // 设置全局请求头\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n      \r\n      // 登录后启动不活动计时器\r\n      dispatch('startInactivityTimer')\r\n    },\r\n    \r\n    logout({ commit }) {\r\n      commit('clearUserInfo')\r\n      delete axios.defaults.headers.common['Authorization']\r\n    },\r\n    \r\n    // 启动自动登出计时器\r\n    startInactivityTimer({ state, dispatch }) {\r\n      // 清除现有计时器\r\n      if (state.inactivityTimer) {\r\n        clearTimeout(state.inactivityTimer)\r\n      }\r\n      \r\n      // 设置新的计时器\r\n      const timer = setTimeout(() => {\r\n        // 30分钟后自动登出\r\n        dispatch('autoLogout')\r\n      }, state.inactivityTimeout)\r\n      \r\n      // 保存计时器ID\r\n      state.inactivityTimer = timer\r\n    },\r\n    \r\n    // 自动登出处理\r\n    autoLogout({ dispatch }) {\r\n      // 显示提示信息\r\n      Vue.prototype.$message.warning('由于长时间未操作，系统已自动退出登录')\r\n      // 执行登出\r\n      dispatch('logout')\r\n      // 跳转到登录页\r\n      router.push('/login')\r\n    },\r\n    \r\n    // 重置自动登出计时器\r\n    resetInactivityTimer({ dispatch }) {\r\n      dispatch('startInactivityTimer')\r\n    }\r\n  }\r\n}) "],"mappings":"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","ignoreList":[]}]}