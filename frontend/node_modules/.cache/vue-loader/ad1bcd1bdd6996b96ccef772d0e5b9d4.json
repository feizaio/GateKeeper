{"remainingRequest":"D:\\gatekeeper\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\gatekeeper\\frontend\\src\\components\\ServiceManager.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\gatekeeper\\frontend\\src\\components\\ServiceManager.vue","mtime":1752645802056},{"path":"D:\\gatekeeper\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747724956321},{"path":"D:\\gatekeeper\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1747724958365},{"path":"D:\\gatekeeper\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747724956321},{"path":"D:\\gatekeeper\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1747724959585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NlcnZpY2VNYW5hZ2VyJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWRkRm9ybTogewogICAgICAgIHVybDogJycsCiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIGlzX3B1YmxpYzogZmFsc2UKICAgICAgfSwKICAgICAgZm9ybVJ1bGVzOiB7CiAgICAgICAgdXJsOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6aG16Z2i5Zyw5Z2AJywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBwYXR0ZXJuOiAvXihodHRwcz86XC9cLyk/KFtcZGEtei4tXSspXC4oW2Etei5dezIsNn0pKFsvXHcgLi1dKikqXC8/JC8sIAogICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5pyJ5pWI55qEVVJM5Zyw5Z2AJywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIGlmcmFtZXM6IFtdLAogICAgICBzZWxlY3RlZElkeDogbnVsbCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGVycm9yOiBudWxsLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgYWRkRGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGRlbGV0ZUNvbmZpcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgZGVsZXRlTG9hZGluZzogZmFsc2UsCiAgICAgIGluZGV4VG9EZWxldGU6IG51bGwsCiAgICAgIAogICAgICAvLyDmnYPpmZDnrqHnkIbnm7jlhbMKICAgICAgcGVybWlzc2lvbkRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBwZXJtaXNzaW9uTG9hZGluZzogZmFsc2UsCiAgICAgIHNlbGVjdGVkU2VydmljZTogbnVsbCwKICAgICAgcGVybWlzc2lvbkZvcm06IHsKICAgICAgICBpc19wdWJsaWM6IGZhbHNlLAogICAgICAgIHBlcm1pc3Npb25zOiBbXQogICAgICB9LAogICAgICAKICAgICAgLy8g5re75Yqg55So5oi35p2D6ZmQCiAgICAgIGFkZFVzZXJQZXJtaXNzaW9uRGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIG5ld1VzZXJQZXJtaXNzaW9uOiB7CiAgICAgICAgdXNlcl9pZDogbnVsbCwKICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgY2FuX3ZpZXc6IHRydWUsCiAgICAgICAgY2FuX2VkaXQ6IGZhbHNlLAogICAgICAgIGNhbl9kZWxldGU6IGZhbHNlCiAgICAgIH0sCiAgICAgIGF2YWlsYWJsZVVzZXJzOiBbXQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGN1cnJlbnRVc2VyKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlciB8fCB7fTsKICAgIH0sCiAgICBpc0FkbWluKCkgewogICAgICByZXR1cm4gdGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLmlzX2FkbWluOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMubG9hZFNlcnZpY2VzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDmmL7npLrmt7vliqDlr7nor53moYYKICAgIHNob3dBZGREaWFsb2coKSB7CiAgICAgIHRoaXMuYWRkRGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgIC8vIOW7tui/n+iBmueEpuWIsFVSTOi+k+WFpeahhgogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgY29uc3QgaW5wdXRFbCA9IHRoaXMuJHJlZnMuYWRkRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpOwogICAgICAgIGlmIChpbnB1dEVsKSB7CiAgICAgICAgICBpbnB1dEVsLmZvY3VzKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAKICAgIC8vIOmHjee9ruihqOWNlQogICAgcmVzZXRGb3JtKCkgewogICAgICB0aGlzLmFkZEZvcm0gPSB7CiAgICAgICAgdXJsOiAnJywKICAgICAgICB0aXRsZTogJycsCiAgICAgICAgaXNfcHVibGljOiBmYWxzZQogICAgICB9OwogICAgICBpZiAodGhpcy4kcmVmcy5hZGRGb3JtKSB7CiAgICAgICAgdGhpcy4kcmVmcy5hZGRGb3JtLnJlc2V0RmllbGRzKCk7CiAgICAgIH0KICAgIH0sCiAgICAKICAgIC8vIOWKoOi9veacjeWKoeWIl+ihqAogICAgYXN5bmMgbG9hZFNlcnZpY2VzKCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoJy9hcGkvc2VydmljZXMnKTsKICAgICAgICB0aGlzLmlmcmFtZXMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5kYXRhICYmIGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IgPyBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yIDogJ+WKoOi9veacjeWKoeWksei0pSc7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLmVycm9yKTsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIAogICAgLy8g5re75Yqg5pyN5YqhCiAgICBhc3luYyBhZGRJZnJhbWUoKSB7CiAgICAgIC8vIOihqOWNlemqjOivgQogICAgICB0aGlzLiRyZWZzLmFkZEZvcm0udmFsaWRhdGUoYXN5bmMgKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIAogICAgICAgICAgLy8g5aaC5p6cVVJM5LiN5YyF5ZCraHR0cOaIlmh0dHBz77yM5re75YqgaHR0cDovL+WJjee8gAogICAgICAgICAgbGV0IHVybCA9IHRoaXMuYWRkRm9ybS51cmwudHJpbSgpOwogICAgICAgICAgaWYgKCEvXmh0dHBzPzpcL1wvL2kudGVzdCh1cmwpKSB7CiAgICAgICAgICAgIHVybCA9ICdodHRwOi8vJyArIHVybDsKICAgICAgICAgIH0KICAgICAgICAgIAogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KCcvYXBpL3NlcnZpY2VzJywgewogICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgdGl0bGU6IHRoaXMuYWRkRm9ybS50aXRsZS50cmltKCksCiAgICAgICAgICAgIGlzX3B1YmxpYzogdGhpcy5hZGRGb3JtLmlzX3B1YmxpYwogICAgICAgICAgfSk7CiAgICAgICAgICAKICAgICAgICAgIHRoaXMuaWZyYW1lcy5wdXNoKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmt7vliqDmiJDlip8nKTsKICAgICAgICAgIHRoaXMuYWRkRGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5kYXRhICYmIGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IgPyBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yIDogJ+a3u+WKoOacjeWKoeWksei0pSc7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHRoaXMuZXJyb3IpOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAKICAgIC8vIOWkhOeQhuWNoeeJh+iPnOWNleWRveS7pAogICAgaGFuZGxlQ29tbWFuZChjb21tYW5kLCBpZHgpIHsKICAgICAgaWYgKGNvbW1hbmQgPT09ICd2aWV3JykgewogICAgICAgIHRoaXMuc2VsZWN0SWZyYW1lKGlkeCk7CiAgICAgIH0gZWxzZSBpZiAoY29tbWFuZCA9PT0gJ2RlbGV0ZScpIHsKICAgICAgICB0aGlzLmluZGV4VG9EZWxldGUgPSBpZHg7CiAgICAgICAgdGhpcy5kZWxldGVDb25maXJtVmlzaWJsZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoY29tbWFuZCA9PT0gJ3NoYXJlJykgewogICAgICAgIHRoaXMuc2hvd1Blcm1pc3Npb25EaWFsb2coaWR4KTsKICAgICAgfQogICAgfSwKICAgIAogICAgLy8g56Gu6K6k5Yig6ZmkCiAgICBhc3luYyBjb25maXJtRGVsZXRlKCkgewogICAgICBpZiAodGhpcy5pbmRleFRvRGVsZXRlID09PSBudWxsKSByZXR1cm47CiAgICAgIAogICAgICB0aGlzLmRlbGV0ZUxvYWRpbmcgPSB0cnVlOwogICAgICBhd2FpdCB0aGlzLnJlbW92ZUlmcmFtZSh0aGlzLmluZGV4VG9EZWxldGUpOwogICAgICB0aGlzLmRlbGV0ZUxvYWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5kZWxldGVDb25maXJtVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmluZGV4VG9EZWxldGUgPSBudWxsOwogICAgfSwKICAgIAogICAgLy8g5Yig6Zmk5pyN5YqhCiAgICBhc3luYyByZW1vdmVJZnJhbWUoaWR4VG9SZW1vdmUpIHsKICAgICAgY29uc3Qgc2VydmljZVRvUmVtb3ZlID0gdGhpcy5pZnJhbWVzW2lkeFRvUmVtb3ZlXTsKICAgICAgCiAgICAgIC8vIOWmguaenOayoeaciUlE77yM6K+05piO5piv5pys5Zyw5re75Yqg55qE5pyq5L+d5a2Y55qE5pyN5YqhCiAgICAgIGlmICghc2VydmljZVRvUmVtb3ZlLmlkKSB7CiAgICAgICAgdGhpcy5pZnJhbWVzLnNwbGljZShpZHhUb1JlbW92ZSwgMSk7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJZHggPT09IGlkeFRvUmVtb3ZlKSB7CiAgICAgICAgICB0aGlzLmNsb3NlSWZyYW1lQ29udGVudCgpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZElkeCA+IGlkeFRvUmVtb3ZlKSB7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkSWR4LS07CiAgICAgICAgfQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5YqfJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIAogICAgICB0cnkgewogICAgICAgIC8vIOiuvue9ruWIoOmZpOS4reeKtuaAgQogICAgICAgIHRoaXMuJHNldCh0aGlzLmlmcmFtZXNbaWR4VG9SZW1vdmVdLCAnZGVsZXRpbmcnLCB0cnVlKTsKICAgICAgICAKICAgICAgICBhd2FpdCBheGlvcy5kZWxldGUoYC9hcGkvc2VydmljZXMvJHtzZXJ2aWNlVG9SZW1vdmUuaWR9YCk7CiAgICAgICAgCiAgICAgICAgdGhpcy5pZnJhbWVzLnNwbGljZShpZHhUb1JlbW92ZSwgMSk7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJZHggPT09IGlkeFRvUmVtb3ZlKSB7CiAgICAgICAgICB0aGlzLmNsb3NlSWZyYW1lQ29udGVudCgpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZElkeCA+IGlkeFRvUmVtb3ZlKSB7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkSWR4LS07CiAgICAgICAgfQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5YqfJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEgJiYgZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvciA/IGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IgOiAn5Yig6Zmk5pyN5Yqh5aSx6LSlJzsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHRoaXMuZXJyb3IpOwogICAgICAgIC8vIOWPlua2iOWIoOmZpOS4reeKtuaAgQogICAgICAgIGlmICh0aGlzLmlmcmFtZXNbaWR4VG9SZW1vdmVdKSB7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5pZnJhbWVzW2lkeFRvUmVtb3ZlXSwgJ2RlbGV0aW5nJywgZmFsc2UpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIAogICAgc2VsZWN0SWZyYW1lKGlkeCkgewogICAgICB0aGlzLnNlbGVjdGVkSWR4ID0gaWR4OwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIAogICAgY2xvc2VJZnJhbWVDb250ZW50KCkgewogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5zZWxlY3RlZElkeCA9IG51bGw7CiAgICB9LAogICAgCiAgICAvLyDmoLzlvI/ljJZVUkzmmL7npLoKICAgIGZvcm1hdFVybCh1cmwpIHsKICAgICAgaWYgKCF1cmwpIHJldHVybiAnJzsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7CiAgICAgICAgcmV0dXJuIHVybE9iai5ob3N0bmFtZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiB1cmw7CiAgICAgIH0KICAgIH0sCiAgICAKICAgIC8vIOagvOW8j+WMluaXpeacn+aYvuekugogICAgZm9ybWF0RGF0ZShkYXRlU3RyKSB7CiAgICAgIGlmICghZGF0ZVN0cikgcmV0dXJuICcnOwogICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cik7CiAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlU3RyaW5nKCd6aC1DTicsIHsKICAgICAgICB5ZWFyOiAnbnVtZXJpYycsCiAgICAgICAgbW9udGg6ICcyLWRpZ2l0JywKICAgICAgICBkYXk6ICcyLWRpZ2l0JywKICAgICAgICBob3VyOiAnMi1kaWdpdCcsCiAgICAgICAgbWludXRlOiAnMi1kaWdpdCcKICAgICAgfSk7CiAgICB9LAogICAgCiAgICAvLyDmnYPpmZDnm7jlhbPmlrnms5UKICAgIAogICAgLy8g5Yik5pat5b2T5YmN55So5oi35piv5ZCm5Y+v5Lul5Yig6Zmk5pyN5YqhCiAgICBjYW5EZWxldGUoc2VydmljZSkgewogICAgICBpZiAoIXNlcnZpY2UpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRoaXMuaXNBZG1pbiB8fCBzZXJ2aWNlLnVzZXJfaWQgPT09IHRoaXMuY3VycmVudFVzZXIuaWQ7CiAgICB9LAogICAgCiAgICAvLyDliKTmlq3lvZPliY3nlKjmiLfmmK/lkKblj6/ku6XnrqHnkIbmnYPpmZAKICAgIGNhbk1hbmFnZVBlcm1pc3Npb25zKHNlcnZpY2UpIHsKICAgICAgaWYgKCFzZXJ2aWNlKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0aGlzLmlzQWRtaW4gfHwgc2VydmljZS51c2VyX2lkID09PSB0aGlzLmN1cnJlbnRVc2VyLmlkOwogICAgfSwKICAgIAogICAgLy8g5pi+56S65p2D6ZmQ6K6+572u5a+56K+d5qGGCiAgICBhc3luYyBzaG93UGVybWlzc2lvbkRpYWxvZyhpZHgpIHsKICAgICAgaWYgKGlkeCA9PT0gbnVsbCB8fCAhdGhpcy5pZnJhbWVzW2lkeF0pIHJldHVybjsKICAgICAgCiAgICAgIHRoaXMuc2VsZWN0ZWRTZXJ2aWNlID0gdGhpcy5pZnJhbWVzW2lkeF07CiAgICAgIHRoaXMucGVybWlzc2lvbkxvYWRpbmcgPSB0cnVlOwogICAgICAKICAgICAgdHJ5IHsKICAgICAgICAvLyDojrflj5bmnI3liqHmnYPpmZDorr7nva4KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChgL2FwaS9zZXJ2aWNlcy8ke3RoaXMuc2VsZWN0ZWRTZXJ2aWNlLmlkfS9wZXJtaXNzaW9uc2ApOwogICAgICAgIAogICAgICAgIHRoaXMucGVybWlzc2lvbkZvcm0gPSB7CiAgICAgICAgICBpc19wdWJsaWM6IHJlc3BvbnNlLmRhdGEuaXNfcHVibGljLAogICAgICAgICAgcGVybWlzc2lvbnM6IHJlc3BvbnNlLmRhdGEucGVybWlzc2lvbnMgfHwgW10KICAgICAgICB9OwogICAgICAgIAogICAgICAgIC8vIOiOt+WPluWPr+eUqOeUqOaIt+WIl+ihqAogICAgICAgIGF3YWl0IHRoaXMubG9hZEF2YWlsYWJsZVVzZXJzKCk7CiAgICAgICAgCiAgICAgICAgdGhpcy5wZXJtaXNzaW9uRGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEgJiYgZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvciA/IGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IgOiAn6I635Y+W5p2D6ZmQ6K6+572u5aSx6LSlJzsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHRoaXMuZXJyb3IpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMucGVybWlzc2lvbkxvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIAogICAgLy8g5Yqg6L295Y+v55So55So5oi35YiX6KGoCiAgICBhc3luYyBsb2FkQXZhaWxhYmxlVXNlcnMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoJy9hcGkvdXNlcnMnKTsKICAgICAgICAvLyDov4fmu6TmjonlvZPliY3nlKjmiLflkozlt7LmnInmnYPpmZDnmoTnlKjmiLcKICAgICAgICB0aGlzLmF2YWlsYWJsZVVzZXJzID0gcmVzcG9uc2UuZGF0YS5maWx0ZXIodXNlciA9PiAKICAgICAgICAgIHVzZXIuaWQgIT09IHRoaXMuY3VycmVudFVzZXIuaWQgJiYgCiAgICAgICAgICAhdGhpcy5wZXJtaXNzaW9uRm9ybS5wZXJtaXNzaW9ucy5zb21lKHAgPT4gcC51c2VyX2lkID09PSB1c2VyLmlkKQogICAgICAgICk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W55So5oi35YiX6KGo5aSx6LSlJyk7CiAgICAgIH0KICAgIH0sCiAgICAKICAgIC8vIOaYvuekuua3u+WKoOeUqOaIt+adg+mZkOWvueivneahhgogICAgc2hvd0FkZFVzZXJQZXJtaXNzaW9uKCkgewogICAgICAvLyDph43nva7ooajljZUKICAgICAgdGhpcy5uZXdVc2VyUGVybWlzc2lvbiA9IHsKICAgICAgICB1c2VyX2lkOiBudWxsLAogICAgICAgIGNhbl92aWV3OiB0cnVlLAogICAgICAgIGNhbl9lZGl0OiBmYWxzZSwKICAgICAgICBjYW5fZGVsZXRlOiBmYWxzZQogICAgICB9OwogICAgICAKICAgICAgLy8g5pu05paw5Y+v55So55So5oi35YiX6KGoCiAgICAgIHRoaXMuYWRkVXNlclBlcm1pc3Npb25EaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICAKICAgIC8vIOa3u+WKoOeUqOaIt+adg+mZkAogICAgYWRkVXNlclBlcm1pc3Npb24oKSB7CiAgICAgIGlmICghdGhpcy5uZXdVc2VyUGVybWlzc2lvbi51c2VyX2lkKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fpgInmi6nnlKjmiLcnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgCiAgICAgIC8vIOafpeaJvuWvueW6lOeahOeUqOaIt+WQjQogICAgICBjb25zdCBzZWxlY3RlZFVzZXIgPSB0aGlzLmF2YWlsYWJsZVVzZXJzLmZpbmQodSA9PiB1LmlkID09PSB0aGlzLm5ld1VzZXJQZXJtaXNzaW9uLnVzZXJfaWQpOwogICAgICBpZiAoIXNlbGVjdGVkVXNlcikgcmV0dXJuOwogICAgICAKICAgICAgLy8g5re75Yqg5Yiw5p2D6ZmQ5YiX6KGoCiAgICAgIHRoaXMucGVybWlzc2lvbkZvcm0ucGVybWlzc2lvbnMucHVzaCh7CiAgICAgICAgdXNlcl9pZDogdGhpcy5uZXdVc2VyUGVybWlzc2lvbi51c2VyX2lkLAogICAgICAgIHVzZXJuYW1lOiBzZWxlY3RlZFVzZXIudXNlcm5hbWUsCiAgICAgICAgY2FuX3ZpZXc6IHRydWUsCiAgICAgICAgY2FuX2VkaXQ6IHRoaXMubmV3VXNlclBlcm1pc3Npb24uY2FuX2VkaXQsCiAgICAgICAgY2FuX2RlbGV0ZTogdGhpcy5uZXdVc2VyUGVybWlzc2lvbi5jYW5fZGVsZXRlCiAgICAgIH0pOwogICAgICAKICAgICAgLy8g5LuO5Y+v55So55So5oi35YiX6KGo5Lit56e76ZmkCiAgICAgIHRoaXMuYXZhaWxhYmxlVXNlcnMgPSB0aGlzLmF2YWlsYWJsZVVzZXJzLmZpbHRlcih1ID0+IHUuaWQgIT09IHRoaXMubmV3VXNlclBlcm1pc3Npb24udXNlcl9pZCk7CiAgICAgIAogICAgICB0aGlzLmFkZFVzZXJQZXJtaXNzaW9uRGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIAogICAgLy8g56e76Zmk55So5oi35p2D6ZmQCiAgICByZW1vdmVVc2VyUGVybWlzc2lvbihpbmRleCkgewogICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMucGVybWlzc2lvbkZvcm0ucGVybWlzc2lvbnMubGVuZ3RoKSByZXR1cm47CiAgICAgIAogICAgICAvLyDlsIbnlKjmiLfmt7vliqDlm57lj6/nlKjnlKjmiLfliJfooagKICAgICAgY29uc3QgcmVtb3ZlZFBlcm1pc3Npb24gPSB0aGlzLnBlcm1pc3Npb25Gb3JtLnBlcm1pc3Npb25zW2luZGV4XTsKICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gdGhpcy5hdmFpbGFibGVVc2Vycy5maW5kKHUgPT4gdS5pZCA9PT0gcmVtb3ZlZFBlcm1pc3Npb24udXNlcl9pZCk7CiAgICAgIAogICAgICBpZiAoIWV4aXN0aW5nVXNlcikgewogICAgICAgIHRoaXMuYXZhaWxhYmxlVXNlcnMucHVzaCh7CiAgICAgICAgICBpZDogcmVtb3ZlZFBlcm1pc3Npb24udXNlcl9pZCwKICAgICAgICAgIHVzZXJuYW1lOiByZW1vdmVkUGVybWlzc2lvbi51c2VybmFtZQogICAgICAgIH0pOwogICAgICB9CiAgICAgIAogICAgICAvLyDku47mnYPpmZDliJfooajkuK3np7vpmaQKICAgICAgdGhpcy5wZXJtaXNzaW9uRm9ybS5wZXJtaXNzaW9ucy5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICAgIAogICAgLy8g5L+d5a2Y5p2D6ZmQ6K6+572uCiAgICBhc3luYyBzYXZlUGVybWlzc2lvbnMoKSB7CiAgICAgIGlmICghdGhpcy5zZWxlY3RlZFNlcnZpY2UpIHJldHVybjsKICAgICAgCiAgICAgIHRoaXMucGVybWlzc2lvbkxvYWRpbmcgPSB0cnVlOwogICAgICAKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBheGlvcy5wb3N0KGAvYXBpL3NlcnZpY2VzLyR7dGhpcy5zZWxlY3RlZFNlcnZpY2UuaWR9L3Blcm1pc3Npb25zYCwgdGhpcy5wZXJtaXNzaW9uRm9ybSk7CiAgICAgICAgCiAgICAgICAgLy8g5pu05paw5pys5Zyw5pWw5o2uCiAgICAgICAgY29uc3Qgc2VydmljZUluZGV4ID0gdGhpcy5pZnJhbWVzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IHRoaXMuc2VsZWN0ZWRTZXJ2aWNlLmlkKTsKICAgICAgICBpZiAoc2VydmljZUluZGV4ICE9PSAtMSkgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuaWZyYW1lc1tzZXJ2aWNlSW5kZXhdLCAnaXNfcHVibGljJywgdGhpcy5wZXJtaXNzaW9uRm9ybS5pc19wdWJsaWMpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+adg+mZkOiuvue9ruW3suS/neWtmCcpOwogICAgICAgIHRoaXMucGVybWlzc2lvbkRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YSAmJiBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yID8gZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvciA6ICfkv53lrZjmnYPpmZDorr7nva7lpLHotKUnOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IodGhpcy5lcnJvcik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5wZXJtaXNzaW9uTG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["ServiceManager.vue"],"names":[],"mappings":";AAiNA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ServiceManager.vue","sourceRoot":"src/components","sourcesContent":["\n<template>\n  <div class=\"service-manager\">\n    <div class=\"page-header\">\n      <h2 class=\"page-title\">服务管理</h2>\n      <div class=\"page-description\">添加和管理外部服务页面，方便快速访问</div>\n    </div>\n\n    <!-- 工具栏 -->\n    <div class=\"actions-toolbar\">\n      <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"showAddDialog\" v-if=\"isAdmin\">添加页面</el-button>\n    </div>\n    \n    <!-- 服务列表区域 -->\n    <div class=\"section-title\">\n      <i class=\"el-icon-menu\"></i> 服务列表\n    </div>\n    \n    <!-- 卡片区 -->\n    <div class=\"card-container\">\n      <el-row :gutter=\"20\">\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"8\" :xl=\"6\" v-for=\"(item, idx) in iframes\" :key=\"item.id || idx\">\n          <el-card \n            class=\"iframe-card\" \n            :class=\"{ 'is-active': selectedIdx === idx }\"\n            shadow=\"hover\" \n            @click.native=\"selectIframe(idx)\">\n            <div class=\"card-header\">\n              <div class=\"iframe-title\">{{ item.title || item.url }}</div>\n              <el-dropdown trigger=\"click\" @command=\"handleCommand($event, idx)\" class=\"card-menu\" @click.stop>\n                <span class=\"el-dropdown-link\" @click.stop>\n                  <i class=\"el-icon-more\"></i>\n                </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                  <el-dropdown-item command=\"view\">\n                    <i class=\"el-icon-view\"></i> 查看\n                  </el-dropdown-item>\n                  <el-dropdown-item command=\"share\" v-if=\"canManagePermissions(item)\">\n                    <i class=\"el-icon-share\"></i> 权限设置\n                  </el-dropdown-item>\n                  <el-dropdown-item command=\"delete\" divided v-if=\"canDelete(item)\">\n                    <i class=\"el-icon-delete\"></i> 删除\n                  </el-dropdown-item>\n                </el-dropdown-menu>\n              </el-dropdown>\n            </div>\n            <div class=\"card-content\">\n              <div class=\"url-preview\">{{ formatUrl(item.url) }}</div>\n              <div class=\"card-footer\">\n                <span class=\"time-info\" v-if=\"item.created_at\">创建于 {{ formatDate(item.created_at) }}</span>\n                <el-tag size=\"mini\" type=\"success\" v-if=\"item.is_public\">公共</el-tag>\n                <el-tag size=\"mini\" type=\"info\" v-if=\"item.user_id === currentUser.id\">我的</el-tag>\n              </div>\n            </div>\n          </el-card>\n        </el-col>\n        \n        <!-- 空状态提示 -->\n        <el-col :span=\"24\" v-if=\"iframes.length === 0\">\n          <div class=\"empty-tip\">\n            <i class=\"el-icon-info\" style=\"font-size: 48px; margin-bottom: 16px;\"></i>\n            <span>暂无服务页面，点击\"添加页面\"按钮添加新的服务</span>\n          </div>\n        </el-col>\n      </el-row>\n    </div>\n\n    <!-- 添加服务对话框 -->\n    <el-dialog title=\"添加服务页面\" :visible.sync=\"addDialogVisible\" width=\"30%\" @closed=\"resetForm\">\n      <el-form :model=\"addForm\" :rules=\"formRules\" ref=\"addForm\" label-width=\"80px\">\n        <el-form-item label=\"标题\" prop=\"title\">\n          <el-input v-model=\"addForm.title\" placeholder=\"请输入服务标题\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"地址\" prop=\"url\">\n          <el-input v-model=\"addForm.url\" placeholder=\"请输入服务地址，例如: http://example.com\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"公共页面\">\n          <el-switch v-model=\"addForm.is_public\"></el-switch>\n          <div class=\"form-tip\">开启后，所有用户都可以访问此服务页面</div>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"addIframe\" :loading=\"loading\">确定</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 服务内容对话框 -->\n    <el-dialog \n      :title=\"(iframes[selectedIdx] && iframes[selectedIdx].title) || (iframes[selectedIdx] && iframes[selectedIdx].url)\" \n      :visible.sync=\"dialogVisible\" \n      width=\"90%\" \n      :before-close=\"closeIframeContent\"\n      class=\"iframe-dialog\"\n      fullscreen>\n      <iframe v-if=\"selectedIdx !== null && iframes[selectedIdx]\" :src=\"iframes[selectedIdx].url\" class=\"iframe-content\"></iframe>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"closeIframeContent\">关闭</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 删除确认对话框 -->\n    <el-dialog\n      title=\"确认删除\"\n      :visible.sync=\"deleteConfirmVisible\"\n      width=\"30%\">\n      <span>确定要删除此服务页面吗？</span>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"deleteConfirmVisible = false\">取消</el-button>\n        <el-button type=\"danger\" @click=\"confirmDelete\" :loading=\"deleteLoading\">删除</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 权限设置对话框 -->\n    <el-dialog\n      title=\"权限设置\"\n      :visible.sync=\"permissionDialogVisible\"\n      width=\"50%\">\n      <div v-if=\"selectedService\">\n        <el-form label-width=\"120px\">\n          <el-form-item label=\"公共页面\">\n            <el-switch v-model=\"permissionForm.is_public\"></el-switch>\n            <div class=\"form-tip\">开启后，所有用户都可以访问此服务页面</div>\n          </el-form-item>\n        </el-form>\n        \n        <div class=\"section-divider\">\n          <span>用户权限</span>\n        </div>\n        \n        <div class=\"user-permissions\">\n          <div class=\"user-permissions-header\">\n            <el-button size=\"small\" type=\"primary\" @click=\"showAddUserPermission\">\n              <i class=\"el-icon-plus\"></i> 添加用户\n            </el-button>\n          </div>\n          \n          <el-table :data=\"permissionForm.permissions\" style=\"width: 100%\">\n            <el-table-column prop=\"username\" label=\"用户名\"></el-table-column>\n            <el-table-column label=\"查看权限\">\n              <template slot-scope=\"scope\">\n                <el-switch v-model=\"scope.row.can_view\" disabled></el-switch>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"编辑权限\">\n              <template slot-scope=\"scope\">\n                <el-switch v-model=\"scope.row.can_edit\"></el-switch>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"删除权限\">\n              <template slot-scope=\"scope\">\n                <el-switch v-model=\"scope.row.can_delete\"></el-switch>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" width=\"80\">\n              <template slot-scope=\"scope\">\n                <el-button \n                  size=\"mini\" \n                  type=\"danger\" \n                  icon=\"el-icon-delete\"\n                  @click=\"removeUserPermission(scope.$index)\">\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n          \n          <div class=\"empty-tip\" v-if=\"permissionForm.permissions.length === 0\">\n            <span>暂无用户权限，点击\"添加用户\"按钮设置用户权限</span>\n          </div>\n        </div>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"permissionDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"savePermissions\" :loading=\"permissionLoading\">保存</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 添加用户权限对话框 -->\n    <el-dialog\n      title=\"添加用户权限\"\n      :visible.sync=\"addUserPermissionDialogVisible\"\n      width=\"30%\">\n      <el-form :model=\"newUserPermission\" label-width=\"80px\">\n        <el-form-item label=\"用户\">\n          <el-select v-model=\"newUserPermission.user_id\" placeholder=\"请选择用户\" style=\"width: 100%\">\n            <el-option\n              v-for=\"user in availableUsers\"\n              :key=\"user.id\"\n              :label=\"user.username\"\n              :value=\"user.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"编辑权限\">\n          <el-switch v-model=\"newUserPermission.can_edit\"></el-switch>\n        </el-form-item>\n        <el-form-item label=\"删除权限\">\n          <el-switch v-model=\"newUserPermission.can_delete\"></el-switch>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addUserPermissionDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"addUserPermission\">确定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  name: 'ServiceManager',\n  data() {\n    return {\n      addForm: {\n        url: '',\n        title: '',\n        is_public: false\n      },\n      formRules: {\n        url: [\n          { required: true, message: '请输入页面地址', trigger: 'blur' },\n          { type: 'string', pattern: /^(https?:\\/\\/)?([\\da-z.-]+)\\.([a-z.]{2,6})([/\\w .-]*)*\\/?$/, \n            message: '请输入有效的URL地址', trigger: 'blur' }\n        ]\n      },\n      iframes: [],\n      selectedIdx: null,\n      loading: false,\n      error: null,\n      dialogVisible: false,\n      addDialogVisible: false,\n      deleteConfirmVisible: false,\n      deleteLoading: false,\n      indexToDelete: null,\n      \n      // 权限管理相关\n      permissionDialogVisible: false,\n      permissionLoading: false,\n      selectedService: null,\n      permissionForm: {\n        is_public: false,\n        permissions: []\n      },\n      \n      // 添加用户权限\n      addUserPermissionDialogVisible: false,\n      newUserPermission: {\n        user_id: null,\n        username: '',\n        can_view: true,\n        can_edit: false,\n        can_delete: false\n      },\n      availableUsers: []\n    }\n  },\n  computed: {\n    currentUser() {\n      return this.$store.state.user || {};\n    },\n    isAdmin() {\n      return this.currentUser && this.currentUser.is_admin;\n    }\n  },\n  mounted() {\n    this.loadServices();\n  },\n  methods: {\n    // 显示添加对话框\n    showAddDialog() {\n      this.addDialogVisible = true;\n      // 延迟聚焦到URL输入框\n      this.$nextTick(() => {\n        const inputEl = this.$refs.addForm.querySelector('input');\n        if (inputEl) {\n          inputEl.focus();\n        }\n      });\n    },\n    \n    // 重置表单\n    resetForm() {\n      this.addForm = {\n        url: '',\n        title: '',\n        is_public: false\n      };\n      if (this.$refs.addForm) {\n        this.$refs.addForm.resetFields();\n      }\n    },\n    \n    // 加载服务列表\n    async loadServices() {\n      try {\n        this.loading = true;\n        const response = await axios.get('/api/services');\n        this.iframes = response.data;\n        this.loading = false;\n      } catch (error) {\n        this.error = error.response && error.response.data && error.response.data.error ? error.response.data.error : '加载服务失败';\n        this.$message.error(this.error);\n        this.loading = false;\n      }\n    },\n    \n    // 添加服务\n    async addIframe() {\n      // 表单验证\n      this.$refs.addForm.validate(async (valid) => {\n        if (!valid) {\n          return false;\n        }\n        \n        try {\n          this.loading = true;\n          \n          // 如果URL不包含http或https，添加http://前缀\n          let url = this.addForm.url.trim();\n          if (!/^https?:\\/\\//i.test(url)) {\n            url = 'http://' + url;\n          }\n          \n          const response = await axios.post('/api/services', {\n            url: url,\n            title: this.addForm.title.trim(),\n            is_public: this.addForm.is_public\n          });\n          \n          this.iframes.push(response.data);\n          this.$message.success('添加成功');\n          this.addDialogVisible = false;\n          this.loading = false;\n        } catch (error) {\n          this.error = error.response && error.response.data && error.response.data.error ? error.response.data.error : '添加服务失败';\n          this.$message.error(this.error);\n          this.loading = false;\n        }\n      });\n    },\n    \n    // 处理卡片菜单命令\n    handleCommand(command, idx) {\n      if (command === 'view') {\n        this.selectIframe(idx);\n      } else if (command === 'delete') {\n        this.indexToDelete = idx;\n        this.deleteConfirmVisible = true;\n      } else if (command === 'share') {\n        this.showPermissionDialog(idx);\n      }\n    },\n    \n    // 确认删除\n    async confirmDelete() {\n      if (this.indexToDelete === null) return;\n      \n      this.deleteLoading = true;\n      await this.removeIframe(this.indexToDelete);\n      this.deleteLoading = false;\n      this.deleteConfirmVisible = false;\n      this.indexToDelete = null;\n    },\n    \n    // 删除服务\n    async removeIframe(idxToRemove) {\n      const serviceToRemove = this.iframes[idxToRemove];\n      \n      // 如果没有ID，说明是本地添加的未保存的服务\n      if (!serviceToRemove.id) {\n        this.iframes.splice(idxToRemove, 1);\n        if (this.selectedIdx === idxToRemove) {\n          this.closeIframeContent();\n        } else if (this.selectedIdx > idxToRemove) {\n          this.selectedIdx--;\n        }\n        this.$message.success('删除成功');\n        return;\n      }\n      \n      try {\n        // 设置删除中状态\n        this.$set(this.iframes[idxToRemove], 'deleting', true);\n        \n        await axios.delete(`/api/services/${serviceToRemove.id}`);\n        \n        this.iframes.splice(idxToRemove, 1);\n        if (this.selectedIdx === idxToRemove) {\n          this.closeIframeContent();\n        } else if (this.selectedIdx > idxToRemove) {\n          this.selectedIdx--;\n        }\n        this.$message.success('删除成功');\n      } catch (error) {\n        this.error = error.response && error.response.data && error.response.data.error ? error.response.data.error : '删除服务失败';\n        this.$message.error(this.error);\n        // 取消删除中状态\n        if (this.iframes[idxToRemove]) {\n          this.$set(this.iframes[idxToRemove], 'deleting', false);\n        }\n      }\n    },\n    \n    selectIframe(idx) {\n      this.selectedIdx = idx;\n      this.dialogVisible = true;\n    },\n    \n    closeIframeContent() {\n      this.dialogVisible = false;\n      this.selectedIdx = null;\n    },\n    \n    // 格式化URL显示\n    formatUrl(url) {\n      if (!url) return '';\n      try {\n        const urlObj = new URL(url);\n        return urlObj.hostname;\n      } catch (e) {\n        return url;\n      }\n    },\n    \n    // 格式化日期显示\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    },\n    \n    // 权限相关方法\n    \n    // 判断当前用户是否可以删除服务\n    canDelete(service) {\n      if (!service) return false;\n      return this.isAdmin || service.user_id === this.currentUser.id;\n    },\n    \n    // 判断当前用户是否可以管理权限\n    canManagePermissions(service) {\n      if (!service) return false;\n      return this.isAdmin || service.user_id === this.currentUser.id;\n    },\n    \n    // 显示权限设置对话框\n    async showPermissionDialog(idx) {\n      if (idx === null || !this.iframes[idx]) return;\n      \n      this.selectedService = this.iframes[idx];\n      this.permissionLoading = true;\n      \n      try {\n        // 获取服务权限设置\n        const response = await axios.get(`/api/services/${this.selectedService.id}/permissions`);\n        \n        this.permissionForm = {\n          is_public: response.data.is_public,\n          permissions: response.data.permissions || []\n        };\n        \n        // 获取可用用户列表\n        await this.loadAvailableUsers();\n        \n        this.permissionDialogVisible = true;\n      } catch (error) {\n        this.error = error.response && error.response.data && error.response.data.error ? error.response.data.error : '获取权限设置失败';\n        this.$message.error(this.error);\n      } finally {\n        this.permissionLoading = false;\n      }\n    },\n    \n    // 加载可用用户列表\n    async loadAvailableUsers() {\n      try {\n        const response = await axios.get('/api/users');\n        // 过滤掉当前用户和已有权限的用户\n        this.availableUsers = response.data.filter(user => \n          user.id !== this.currentUser.id && \n          !this.permissionForm.permissions.some(p => p.user_id === user.id)\n        );\n      } catch (error) {\n        this.$message.error('获取用户列表失败');\n      }\n    },\n    \n    // 显示添加用户权限对话框\n    showAddUserPermission() {\n      // 重置表单\n      this.newUserPermission = {\n        user_id: null,\n        can_view: true,\n        can_edit: false,\n        can_delete: false\n      };\n      \n      // 更新可用用户列表\n      this.addUserPermissionDialogVisible = true;\n    },\n    \n    // 添加用户权限\n    addUserPermission() {\n      if (!this.newUserPermission.user_id) {\n        this.$message.warning('请选择用户');\n        return;\n      }\n      \n      // 查找对应的用户名\n      const selectedUser = this.availableUsers.find(u => u.id === this.newUserPermission.user_id);\n      if (!selectedUser) return;\n      \n      // 添加到权限列表\n      this.permissionForm.permissions.push({\n        user_id: this.newUserPermission.user_id,\n        username: selectedUser.username,\n        can_view: true,\n        can_edit: this.newUserPermission.can_edit,\n        can_delete: this.newUserPermission.can_delete\n      });\n      \n      // 从可用用户列表中移除\n      this.availableUsers = this.availableUsers.filter(u => u.id !== this.newUserPermission.user_id);\n      \n      this.addUserPermissionDialogVisible = false;\n    },\n    \n    // 移除用户权限\n    removeUserPermission(index) {\n      if (index < 0 || index >= this.permissionForm.permissions.length) return;\n      \n      // 将用户添加回可用用户列表\n      const removedPermission = this.permissionForm.permissions[index];\n      const existingUser = this.availableUsers.find(u => u.id === removedPermission.user_id);\n      \n      if (!existingUser) {\n        this.availableUsers.push({\n          id: removedPermission.user_id,\n          username: removedPermission.username\n        });\n      }\n      \n      // 从权限列表中移除\n      this.permissionForm.permissions.splice(index, 1);\n    },\n    \n    // 保存权限设置\n    async savePermissions() {\n      if (!this.selectedService) return;\n      \n      this.permissionLoading = true;\n      \n      try {\n        await axios.post(`/api/services/${this.selectedService.id}/permissions`, this.permissionForm);\n        \n        // 更新本地数据\n        const serviceIndex = this.iframes.findIndex(s => s.id === this.selectedService.id);\n        if (serviceIndex !== -1) {\n          this.$set(this.iframes[serviceIndex], 'is_public', this.permissionForm.is_public);\n        }\n        \n        this.$message.success('权限设置已保存');\n        this.permissionDialogVisible = false;\n      } catch (error) {\n        this.error = error.response && error.response.data && error.response.data.error ? error.response.data.error : '保存权限设置失败';\n        this.$message.error(this.error);\n      } finally {\n        this.permissionLoading = false;\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.service-manager {\n  padding: 20px;\n}\n\n.page-header {\n  margin-bottom: 24px;\n}\n\n.page-title {\n  font-size: 24px;\n  color: #303133;\n  margin: 0 0 8px 0;\n  font-weight: 500;\n}\n\n.page-description {\n  color: #606266;\n  font-size: 14px;\n}\n\n.actions-toolbar {\n  display: flex;\n  justify-content: flex-start;\n  margin-bottom: 20px;\n}\n\n.section-title {\n  margin: 25px 0 15px 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: #5B6B8B;\n  display: flex;\n  align-items: center;\n}\n\n.section-title i {\n  margin-right: 8px;\n  font-size: 18px;\n}\n\n.card-container {\n  margin-bottom: 20px;\n  min-height: 120px;\n}\n\n.iframe-card {\n  margin-bottom: 15px;\n  cursor: pointer;\n  transition: all 0.3s;\n  border-radius: 8px;\n  overflow: hidden;\n  height: 150px;\n  display: flex;\n  flex-direction: column;\n}\n\n.iframe-card.is-active {\n  border: 2px solid #4B7BE5;\n  transform: translateY(-2px);\n}\n\n.iframe-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 15px;\n  background: linear-gradient(to right, #4B7BE5, #5B8FF9);\n  color: white;\n}\n\n.iframe-title {\n  flex: 1;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-weight: 500;\n  font-size: 14px;\n}\n\n.card-menu {\n  color: white;\n}\n\n.el-dropdown-link {\n  cursor: pointer;\n  font-size: 16px;\n}\n\n.card-content {\n  padding: 15px;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.url-preview {\n  color: #909399;\n  font-size: 13px;\n  margin-bottom: 10px;\n}\n\n.card-footer {\n  margin-top: auto;\n  font-size: 12px;\n  color: #909399;\n  display: flex;\n  justify-content: space-between;\n}\n\n.empty-tip {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n  height: 200px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 2px 12px 0 rgba(0,0,0,0.05);\n  padding: 20px;\n}\n\n.iframe-content {\n  width: 100%;\n  height: calc(100vh - 200px);\n  border: none;\n}\n\n.iframe-dialog .el-dialog__body {\n  padding: 0;\n}\n\n.form-tip {\n  color: #909399;\n  font-size: 12px;\n  margin-top: 4px;\n}\n\n.section-divider {\n  display: flex;\n  align-items: center;\n  margin: 24px 0;\n  color: #909399;\n  font-size: 14px;\n}\n\n.section-divider::before,\n.section-divider::after {\n  content: '';\n  flex: 1;\n  height: 1px;\n  background: #EBEEF5;\n}\n\n.section-divider::before {\n  margin-right: 12px;\n}\n\n.section-divider::after {\n  margin-left: 12px;\n}\n\n.user-permissions {\n  margin-bottom: 20px;\n}\n\n.user-permissions-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 12px;\n}\n</style>\n"]}]}