{"remainingRequest":"D:\\gatekeeper\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\gatekeeper\\frontend\\src\\components\\Dashboard.vue?vue&type=style&index=0&id=aae30ed8&scoped=true&lang=css","dependencies":[{"path":"D:\\gatekeeper\\frontend\\src\\components\\Dashboard.vue","mtime":1751424519770},{"path":"D:\\gatekeeper\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1747724957296},{"path":"D:\\gatekeeper\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1747724961113},{"path":"D:\\gatekeeper\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1747724958346},{"path":"D:\\gatekeeper\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1747724956321},{"path":"D:\\gatekeeper\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1747724959585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZGFzaGJvYXJkLWNvbnRhaW5lciB7DQogIHBhZGRpbmc6IDA7DQogIHdpZHRoOiAxMDAlOw0KfQ0KDQouc3RhdC1jYXJkcyB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtd3JhcDogd3JhcDsNCiAgZ2FwOiAyMHB4Ow0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KDQouc3RhdC1jYXJkIHsNCiAgZmxleDogMTsNCiAgbWluLXdpZHRoOiAyMjBweDsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBwYWRkaW5nOiAxMHB4Ow0KfQ0KDQouc3RhdC1jYXJkLWNvbnRlbnQgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KfQ0KDQouc3RhdC1jYXJkLXZhbHVlIHsNCiAgZm9udC1zaXplOiAyOHB4Ow0KICBmb250LXdlaWdodDogYm9sZDsNCiAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KfQ0KDQouc3RhdC1jYXJkLWxhYmVsIHsNCiAgZm9udC1zaXplOiAxNHB4Ow0KICBjb2xvcjogIzkwOTM5OTsNCn0NCg0KLnN0YXQtY2FyZC1pY29uIHsNCiAgZm9udC1zaXplOiA0OHB4Ow0KICBjb2xvcjogIzQwOUVGRjsNCiAgb3BhY2l0eTogMC43Ow0KfQ0KDQouc3RhdC1jYXJkLWljb24ud2FybmluZyB7DQogIGNvbG9yOiAjRTZBMjNDOw0KfQ0KDQouY2hhcnQtY29udGFpbmVyIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC13cmFwOiB3cmFwOw0KICBnYXA6IDIwcHg7DQogIG1hcmdpbi1ib3R0b206IDIwcHg7DQp9DQoNCi5jaGFydC1jYXJkIHsNCiAgZmxleDogMTsNCiAgbWluLXdpZHRoOiA0NSU7DQp9DQoNCi5jaGFydC1oZWFkZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5jaGFydC1jb250ZW50IHsNCiAgaGVpZ2h0OiAzMDBweDsNCn0NCg0KLmxvZy1jYXJkIHsNCiAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLmxvZy1oZWFkZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi50YWJsZS1jb250YWluZXIgew0KICB3aWR0aDogMTAwJTsNCiAgb3ZlcmZsb3cteDogYXV0bzsNCn0NCg0KQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7DQogIC5zdGF0LWNhcmQgew0KICAgIG1pbi13aWR0aDogMTAwJTsNCiAgfQ0KICANCiAgLmNoYXJ0LWNhcmQgew0KICAgIG1pbi13aWR0aDogMTAwJTsNCiAgfQ0KfQ0K"},{"version":3,"sources":["Dashboard.vue"],"names":[],"mappings":";AAoUA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Dashboard.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"dashboard-container\">\r\n    <h1>仪表盘</h1>\r\n    \r\n    <!-- 统计卡片 -->\r\n    <div class=\"stat-cards\">\r\n      <el-card class=\"stat-card\" shadow=\"hover\">\r\n        <div class=\"stat-card-content\">\r\n          <div class=\"stat-card-value\">{{ dashboardData.total_servers }}</div>\r\n          <div class=\"stat-card-label\">总资产</div>\r\n        </div>\r\n        <div class=\"stat-card-icon\">\r\n          <i class=\"el-icon-monitor\"></i>\r\n        </div>\r\n      </el-card>\r\n      \r\n      <el-card class=\"stat-card\" shadow=\"hover\">\r\n        <div class=\"stat-card-content\">\r\n          <div class=\"stat-card-value\">{{ dashboardData.total_users }}</div>\r\n          <div class=\"stat-card-label\">在线用户</div>\r\n        </div>\r\n        <div class=\"stat-card-icon\">\r\n          <i class=\"el-icon-user\"></i>\r\n        </div>\r\n      </el-card>\r\n      \r\n      <el-card class=\"stat-card\" shadow=\"hover\">\r\n        <div class=\"stat-card-content\">\r\n          <div class=\"stat-card-value\">{{ dashboardData.today_activities }}</div>\r\n          <div class=\"stat-card-label\">今日会话</div>\r\n        </div>\r\n        <div class=\"stat-card-icon\">\r\n          <i class=\"el-icon-data-line\"></i>\r\n        </div>\r\n      </el-card>\r\n      \r\n      <el-card class=\"stat-card\" shadow=\"hover\">\r\n        <div class=\"stat-card-content\">\r\n          <div class=\"stat-card-value\">{{ dashboardData.alerts }}</div>\r\n          <div class=\"stat-card-label\">告警事件</div>\r\n        </div>\r\n        <div class=\"stat-card-icon warning\">\r\n          <i class=\"el-icon-warning\"></i>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n    \r\n    <!-- 图表区域 -->\r\n    <div class=\"chart-container\">\r\n      <!-- 资产类型分布 -->\r\n      <el-card class=\"chart-card\" shadow=\"hover\">\r\n        <div slot=\"header\" class=\"chart-header\">\r\n          <span>资产类型分布</span>\r\n        </div>\r\n        <div class=\"chart-content\" id=\"asset-type-chart\"></div>\r\n      </el-card>\r\n      \r\n      <!-- 会话趋势 -->\r\n      <el-card class=\"chart-card\" shadow=\"hover\">\r\n        <div slot=\"header\" class=\"chart-header\">\r\n          <span>会话趋势</span>\r\n        </div>\r\n        <div class=\"chart-content\" id=\"activity-trend-chart\"></div>\r\n      </el-card>\r\n    </div>\r\n    \r\n    <!-- 最新活动日志 -->\r\n    <el-card class=\"log-card\" shadow=\"hover\">\r\n      <div slot=\"header\" class=\"log-header\">\r\n        <span>最新活动日志</span>\r\n      </div>\r\n      <div class=\"table-container\">\r\n        <el-table :data=\"dashboardData.recent_activities\" style=\"width: 100%\" stripe>\r\n          <el-table-column prop=\"time\" label=\"时间\" width=\"180\"></el-table-column>\r\n          <el-table-column prop=\"user\" label=\"用户\" width=\"120\"></el-table-column>\r\n          <el-table-column prop=\"action\" label=\"操作\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <span>{{ formatAction(scope.row.action) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"server\" label=\"资产\" width=\"180\"></el-table-column>\r\n          <el-table-column prop=\"ip\" label=\"IP地址\" width=\"140\"></el-table-column>\r\n          <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n            <template slot-scope=\"scope\">\r\n              <el-tag :type=\"scope.row.status === 'success' ? 'success' : 'danger'\" size=\"mini\">\r\n                {{ scope.row.status === 'success' ? '成功' : '失败' }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport * as echarts from 'echarts';\r\n\r\nexport default {\r\n  name: 'Dashboard',\r\n  data() {\r\n    return {\r\n      dashboardData: {\r\n        total_servers: 0,\r\n        total_users: 0,\r\n        today_activities: 0,\r\n        alerts: 0,\r\n        server_type_distribution: {},\r\n        activity_trend: [],\r\n        recent_activities: []\r\n      },\r\n      assetTypeChart: null,\r\n      activityTrendChart: null,\r\n      refreshInterval: null\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fetchDashboardData();\r\n    // 每60秒刷新一次数据\r\n    this.refreshInterval = setInterval(() => {\r\n      this.fetchDashboardData();\r\n    }, 60000);\r\n    \r\n    // 监听窗口大小变化，重新调整图表大小\r\n    window.addEventListener('resize', this.resizeCharts);\r\n  },\r\n  beforeDestroy() {\r\n    // 组件销毁前清除定时器\r\n    if (this.refreshInterval) {\r\n      clearInterval(this.refreshInterval);\r\n    }\r\n    \r\n    // 移除事件监听\r\n    window.removeEventListener('resize', this.resizeCharts);\r\n    \r\n    // 销毁图表实例\r\n    if (this.assetTypeChart) {\r\n      this.assetTypeChart.dispose();\r\n    }\r\n    if (this.activityTrendChart) {\r\n      this.activityTrendChart.dispose();\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchDashboardData() {\r\n      try {\r\n        // 使用真实API调用获取数据\r\n        const response = await axios.get('/api/dashboard/stats');\r\n        this.dashboardData = response.data;\r\n        \r\n        this.$nextTick(() => {\r\n          this.initCharts();\r\n        });\r\n      } catch (error) {\r\n        console.error('获取仪表盘数据失败:', error);\r\n        this.$message.error('获取仪表盘数据失败');\r\n      }\r\n    },\r\n    \r\n    initCharts() {\r\n      this.initAssetTypeChart();\r\n      this.initActivityTrendChart();\r\n    },\r\n    \r\n    initAssetTypeChart() {\r\n      // 初始化资产类型分布图表\r\n      const chartDom = document.getElementById('asset-type-chart');\r\n      if (!chartDom) return;\r\n      \r\n      this.assetTypeChart = echarts.init(chartDom);\r\n      \r\n      const data = [];\r\n      const typeMap = {\r\n        'Windows': 'Windows 服务器',\r\n        'Linux': 'Linux 服务器',\r\n        'Network': '网络设备',\r\n        'Other': '其他'\r\n      };\r\n      \r\n      for (const [type, count] of Object.entries(this.dashboardData.server_type_distribution)) {\r\n        data.push({\r\n          value: count,\r\n          name: typeMap[type] || type\r\n        });\r\n      }\r\n      \r\n      const option = {\r\n        tooltip: {\r\n          trigger: 'item',\r\n          formatter: '{a} <br/>{b}: {c} ({d}%)'\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          left: 10,\r\n          data: data.map(item => item.name)\r\n        },\r\n        series: [\r\n          {\r\n            name: '资产类型',\r\n            type: 'pie',\r\n            radius: ['50%', '70%'],\r\n            avoidLabelOverlap: false,\r\n            label: {\r\n              show: false,\r\n              position: 'center'\r\n            },\r\n            emphasis: {\r\n              label: {\r\n                show: true,\r\n                fontSize: '18',\r\n                fontWeight: 'bold'\r\n              }\r\n            },\r\n            labelLine: {\r\n              show: false\r\n            },\r\n            data: data\r\n          }\r\n        ],\r\n        color: ['#409EFF', '#67C23A', '#E6A23C', '#F56C6C', '#909399']\r\n      };\r\n      \r\n      this.assetTypeChart.setOption(option);\r\n    },\r\n    \r\n    initActivityTrendChart() {\r\n      // 初始化活动趋势图表\r\n      const chartDom = document.getElementById('activity-trend-chart');\r\n      if (!chartDom) return;\r\n      \r\n      this.activityTrendChart = echarts.init(chartDom);\r\n      \r\n      const xAxisData = this.dashboardData.activity_trend.map(item => item.date);\r\n      const seriesData = this.dashboardData.activity_trend.map(item => item.count);\r\n      \r\n      const option = {\r\n        title: {\r\n          text: '近7天会话趋势',\r\n          left: 'center',\r\n          textStyle: {\r\n            fontSize: 14,\r\n            fontWeight: 'normal'\r\n          }\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'shadow',\r\n            label: {\r\n              backgroundColor: '#6a7985'\r\n            }\r\n          }\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: [\r\n          {\r\n            type: 'category',\r\n            data: xAxisData,\r\n            axisLabel: {\r\n              interval: 0,\r\n              rotate: 0\r\n            }\r\n          }\r\n        ],\r\n        yAxis: [\r\n          {\r\n            type: 'value',\r\n            name: '会话数'\r\n          }\r\n        ],\r\n        series: [\r\n          {\r\n            name: '会话数',\r\n            type: 'bar',\r\n            emphasis: {\r\n              focus: 'series'\r\n            },\r\n            data: seriesData,\r\n            itemStyle: {\r\n              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n                {offset: 0, color: '#83bff6'},\r\n                {offset: 0.5, color: '#188df0'},\r\n                {offset: 1, color: '#188df0'}\r\n              ])\r\n            }\r\n          }\r\n        ]\r\n      };\r\n      \r\n      this.activityTrendChart.setOption(option);\r\n    },\r\n    \r\n    resizeCharts() {\r\n      if (this.assetTypeChart) {\r\n        this.assetTypeChart.resize();\r\n      }\r\n      if (this.activityTrendChart) {\r\n        this.activityTrendChart.resize();\r\n      }\r\n    },\r\n    \r\n    formatAction(action) {\r\n      const actionMap = {\r\n        'login': '登录',\r\n        'logout': '登出',\r\n        'connect': '连接',\r\n        'disconnect': '断开',\r\n        'login_failed': '登录失败',\r\n        'connect_failed': '连接失败'\r\n      };\r\n      \r\n      return actionMap[action] || action;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.dashboard-container {\r\n  padding: 0;\r\n  width: 100%;\r\n}\r\n\r\n.stat-cards {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.stat-card {\r\n  flex: 1;\r\n  min-width: 220px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 10px;\r\n}\r\n\r\n.stat-card-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.stat-card-value {\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.stat-card-label {\r\n  font-size: 14px;\r\n  color: #909399;\r\n}\r\n\r\n.stat-card-icon {\r\n  font-size: 48px;\r\n  color: #409EFF;\r\n  opacity: 0.7;\r\n}\r\n\r\n.stat-card-icon.warning {\r\n  color: #E6A23C;\r\n}\r\n\r\n.chart-container {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.chart-card {\r\n  flex: 1;\r\n  min-width: 45%;\r\n}\r\n\r\n.chart-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.chart-content {\r\n  height: 300px;\r\n}\r\n\r\n.log-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.log-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.table-container {\r\n  width: 100%;\r\n  overflow-x: auto;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .stat-card {\r\n    min-width: 100%;\r\n  }\r\n  \r\n  .chart-card {\r\n    min-width: 100%;\r\n  }\r\n}\r\n</style> "]}]}